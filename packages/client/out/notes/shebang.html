<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>shebang | 0X1461A0</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/5db4aa1edde4971b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5db4aa1edde4971b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/38c642bc88044b6e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/38c642bc88044b6e.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2c644d3580cecc35.js" defer=""></script><script src="/_next/static/chunks/framework-325eacbb81921a43.js" defer=""></script><script src="/_next/static/chunks/main-c87967b003e3efc2.js" defer=""></script><script src="/_next/static/chunks/pages/_app-111c29f79e705983.js" defer=""></script><script src="/_next/static/chunks/542-e750f8bef0aa06d2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5B%5B...param%5D%5D-4c9f87d1f418ba6e.js" defer=""></script><script src="/_next/static/OyucwIrXZRgWNxoAUA9lF/_buildManifest.js" defer=""></script><script src="/_next/static/OyucwIrXZRgWNxoAUA9lF/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="flex flex-col min-h-screen"><header class="pb-10 pt-12 text-center shrink-0"><a class="uppercase tracking-widest text-gray-600" href="/">0x1461a0</a></header><main class="flex-auto mb-12"><div class="TOC_table-of-content__KyR_J"><ul><li><a href="#Shebang" data-target-id="h2-Shebang-0">Shebang</a></li><li><a href="#env" data-target-id="h2-env-1">env</a></li></ul></div><div class="article_article-container__yUBmR"><div class="mb-8"><h1 data-title="true" class="mb-0">shebang</h1><p class="opacity-50 !-mt-2"><span>Post: <!-- -->2022.09.18</span><span class="font-bold">·</span><span>Update: <!-- -->2022.09.18</span></p></div><h2>Shebang</h2>
<p>Shebang（也称 hashbang）就是字符序列 <code>#!</code>，通常出现在脚本文件的开头，用于指定脚本解释器的位置，仅在类 Unix 操作系统有效</p>
<p>名称由来：Unix术语中，<code>#</code> 通常称为<em>sharp</em>，<em>hash</em>或<em>mesh</em>，<code>!</code> 常常称为<em>bang</em></p>
<p>具体的语法为：Shebang 后面可以有一个或数个空白字符，跟着执行该脚本所需解释器的<strong>绝对路径</strong>，也可以传递参数给解释器</p>
<p>当直接调用脚本时，系统的程序加载器会分析 <code>#!</code> 后的内容，将这些内容作为解释器指令并调用，同时将该文件路径作为参数</p>
<p>解释器一般都会忽略 <code>#!</code> 开头的首行内容，以提供与 Shebang 的兼容性</p>
<pre><code class="language-shell">// main.js
#! /Users/xiefeng/.nvm/versions/node/v14.17.6/bin/node
console.log(&quot;main.js&quot;)

$ ./main.js  # /Users/xiefeng/.nvm/versions/node/v14.17.6/bin/node ./main.js
</code></pre>
<p>通常写 shell 脚本，文件开头都是 <code>#! /bin/sh</code>，表明该脚本使用 <code>/bin/sh</code> 来解释执行，使用时我们只需 <code>./xxx.sh</code> 调用即可</p>
<h2>env</h2>
<p>对于 node、python 等脚本，Shebang 往往都是以 <code>#! /usr/bin/env</code> 加上 node 和 python 做为参数这样的格式</p>
<pre><code class="language-shell">#! /usr/bin/env python3
</code></pre>
<p><code>env</code> 是一个可以查看当前所有的环境变量的命令，其位置为 <code>/usr/bin/env</code>，由于 PATH 中通常都包含 /usr/bin，所以可以在 shell 中直接执行 <code>env</code></p>
<pre><code class="language-shell">➜ ~ env
SSH_AUTH_SOCK=/private/tmp/com.apple.launchd.RcFvL4jesG/Listeners
PATH=/Users/xiefeng/.nvm/versions/node/v14.17.6/bin:/Library/Frameworks/Python.framework/Versions/3.10/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion Tech Preview.app/Contents/Public:/opt/X11/bin:/Library/Apple/usr/bin:/Users/xiefeng/.cargo/bin:/usr/local/mysql/bin:/usr/local/mysql/support-files
DISPLAY=/private/tmp/com.apple.launchd.cEFmm89qC7/org.xquartz:0
...
</code></pre>
<p>通过向 <code>env</code> 传递参数，会在环境变量中查找名为这个参数的可执行文件，并用使用后续的参数启动该执行文件</p>
<p>通过 <code>#! /usr/bin/env node</code> 这样的写法可以让脚本更通用（跑在别人的电脑上），每个人解释器安装的位置不一定相同</p><div><a href="/notes">cd ..</a></div></div></main><footer class="pb-2 pt-12 text-center shrink-0"><div class="capitalize">copyright <span class="text-2xl align-middle">©</span> <!-- -->2022<!-- --> xie feng</div><div class="text-sm">Powered by NextJS</div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metaTitle":"shebang","article":{"title":"shebang","content":"## Shebang\n\nShebang（也称 hashbang）就是字符序列 `#!`，通常出现在脚本文件的开头，用于指定脚本解释器的位置，仅在类 Unix 操作系统有效\n\n名称由来：Unix术语中，`#` 通常称为*sharp*，*hash*或*mesh*，`!` 常常称为*bang* \n\n具体的语法为：Shebang 后面可以有一个或数个空白字符，跟着执行该脚本所需解释器的**绝对路径**，也可以传递参数给解释器\n\n当直接调用脚本时，系统的程序加载器会分析 `#!` 后的内容，将这些内容作为解释器指令并调用，同时将该文件路径作为参数\n\n解释器一般都会忽略 `#!` 开头的首行内容，以提供与 Shebang 的兼容性\n\n```shell\n// main.js\n#! /Users/xiefeng/.nvm/versions/node/v14.17.6/bin/node\nconsole.log(\"main.js\")\n\n$ ./main.js  # /Users/xiefeng/.nvm/versions/node/v14.17.6/bin/node ./main.js\n```\n\n通常写 shell 脚本，文件开头都是 `#! /bin/sh`，表明该脚本使用 `/bin/sh` 来解释执行，使用时我们只需 `./xxx.sh` 调用即可\n\n## env\n\n对于 node、python 等脚本，Shebang 往往都是以 `#! /usr/bin/env` 加上 node 和 python 做为参数这样的格式\n\n```shell\n#! /usr/bin/env python3\n```\n\n`env` 是一个可以查看当前所有的环境变量的命令，其位置为 `/usr/bin/env`，由于 PATH 中通常都包含 /usr/bin，所以可以在 shell 中直接执行 `env` \n\n```shell\n➜ ~ env\nSSH_AUTH_SOCK=/private/tmp/com.apple.launchd.RcFvL4jesG/Listeners\nPATH=/Users/xiefeng/.nvm/versions/node/v14.17.6/bin:/Library/Frameworks/Python.framework/Versions/3.10/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion Tech Preview.app/Contents/Public:/opt/X11/bin:/Library/Apple/usr/bin:/Users/xiefeng/.cargo/bin:/usr/local/mysql/bin:/usr/local/mysql/support-files\nDISPLAY=/private/tmp/com.apple.launchd.cEFmm89qC7/org.xquartz:0\n...\n```\n\n通过向 `env` 传递参数，会在环境变量中查找名为这个参数的可执行文件，并用使用后续的参数启动该执行文件\n\n通过 `#! /usr/bin/env node` 这样的写法可以让脚本更通用（跑在别人的电脑上），每个人解释器安装的位置不一定相同\n\n\n\n","meta":{"size":2222,"birthTime":1663496641426.4192,"updateTime":1663496641426.595}}},"__N_SSG":true},"page":"/notes/[[...param]]","query":{"param":["shebang"]},"buildId":"OyucwIrXZRgWNxoAUA9lF","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>